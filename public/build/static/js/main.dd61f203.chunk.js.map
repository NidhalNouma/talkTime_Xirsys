{"version":3,"sources":["component/WaveAudio.js","hooks/Xirsys.js","hooks/Main1.js","component/Audio.js","hooks/Call.js","App.js","reportWebVitals.js","index.js"],"names":["WaveAudio","stream","lstream","useState","Wave","wave","lwave","rel","setRel","audio","useRef","useEffect","interval","setTimeout","r","clearTimeout","stopStream","active","fromStream","type","colors","current","srcObject","id","ref","style","display","volume","autoPlay","Xirsys","setRandomUser","Object","$xirsys","_md","media","info","console","log","this","evtListeners","getLocalDevices","then","devices","updateDevices","prototype","localDevices","localStream","DEVICES_UPDATED","ON_LOCAL_STREAM","getUserMedia","constraints","cbSuccess","cbFail","video","own","navigator","mediaDevices","str","emit","enumerateDevices","list","arguments","length","items","audioin","videoin","forEach","device","deviceId","defaults","push","kind","on","sEvent","cbFunc","off","hasOwnProperty","index","indexOf","splice","data","handlers","i","l","apply","_ice","ice","apiUrl","channelPath","channel","cleanChPath","iceServers","ident","secret","doICE","onICEList","xhr","XMLHttpRequest","onreadystatechange","$evt","readyState","status","res","JSON","parse","responseText","filterPaths","v","path","open","setRequestHeader","btoa","send","arr","a","item","url","urls","lastIndexOf","substr","_sig","signal","userName","sig","tmpToken","sigHostPath","pendListeners","heartbeat","connectTo","ver","keepAliveInt","connected","close","stopHeart","doToken","_headers","$","ajax","dataType","headers","error","success","doSignal","host","randomUser","users","setupSocket","WebSocket","addEventListener","evt","startHeart","event","f","msg","pkt","payload","p","meta","m","msgEvent","o","fromPeer","t","split","sysNum","substring","sendMessage","toPeer","undefined","m_event","stringify","clearInterval","setInterval","_p2p","p2p","mediaStream","servers","pc","receiveCandidate","receiveOffer","receiveAnswer","forceTurn","remotePeerID","remoteStreams","isCaller","autoAnswer","peerConnSuccess","peerConnRequest","iceDisconnected","updateMediaStream","addStream","createOffer","desc","setLocalAndSendMessage","catch","err","onCreateSessionDescriptionError","callPeer","custID","createPeerConnection","iceCandidate","rtcIceCandidate","RTCIceCandidate","addIceCandidate","acceptRequest","offer","isVerfied","verified","setRemoteDescription","RTCSessionDescription","e","createAnswer","RTCPeerConnection","onicecandidate","cand","candidate","sdpMid","sdpMLineIndex","onaddstream","addRemoteStream","onremovestream","onconnectionstatechange","connectionState","oniceconnectionstatechange","iceConnectionState","message","hangup","callId","remoteStream","getLiveStream","sessionDescription","setLocalDescription","Main","ch","decodeURI","RegExp","exec","search","mediaConstraints","setLStream","rstream","setRStream","username","setUsername","remoteCallID","setRemoteCallID","peer","setPeer","setSig","setMedia","setIce","call","setCall","inCall","setInCall","onICE","isTURN","getURLParameter","onReady","onStopCall","onStartCall","remoteId","onMediaDevices","mics","cams","camList","micList","empty","append","groupId","label","getTracks","html","name","url_string","window","location","href","c","URL","searchParams","get","setLocalStream","alert","onLoad","s4","Math","floor","random","toString","guid","urlName","Audio","answer","stopAudioOnly","color","height","width","track","stop","Call","state","setState","btnText","setBtnText","click","App","className","onClick","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.dd61f203.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport Wave from \"wave-visualizer\";\n\nfunction WaveAudio({ stream, lstream }) {\n  const [wave] = useState(new Wave());\n  const [lwave] = useState(new Wave());\n  const [rel, setRel] = useState(0);\n\n  const audio = useRef(null);\n\n  useEffect(() => {\n    const interval = setTimeout(() => {\n      setRel((r) => r + 1);\n      // console.log(rel);\n    }, 1000);\n    return () => clearTimeout(interval);\n  }, [rel]);\n\n  useEffect(() => {\n    wave.stopStream();\n    lwave.stopStream();\n    if (stream)\n      if (stream.active)\n        wave.fromStream(stream, \"wave\", {\n          type: \"shine\",\n          colors: [\"rgba(149, 54, 64,1)\", \"white\", \"blue\"],\n        });\n\n    lstream &&\n      lstream.active &&\n      lwave.fromStream(lstream, \"lwave\", {\n        type: \"shine\",\n        colors: [\"rgba(45, 134, 233, 1)\", \"white\", \"blue\"],\n      });\n\n    // console.log(\"Start streaming audio ...\");\n\n    audio.current.srcObject = stream;\n    return () => {\n      wave.stopStream();\n      lwave.stopStream();\n    };\n  }, [lstream, stream, rel]);\n\n  return (\n    <div>\n      <canvas id=\"wave\"></canvas>\n      <br />\n      <canvas id=\"lwave\"></canvas>\n      <audio\n        ref={audio}\n        style={{ display: \"none\" }}\n        volume=\"true\"\n        autoPlay\n      ></audio>\n    </div>\n  );\n}\n\nexport default WaveAudio;\n","import $ from \"jquery\";\nimport { useState, useEffect } from \"react\";\n\n// Media\n\nfunction Xirsys(setRandomUser) {\n  const [$xirsys] = useState(new Object());\n\n  useEffect(() => {\n    let _md = ($xirsys.media = function (info) {\n      if (!info) info = {};\n      console.log(\"*media*  info: \", info);\n      //internal values\n      this.info = info;\n      this.evtListeners = {};\n      this.getLocalDevices().then((devices) => {\n        this.updateDevices(devices);\n      });\n    });\n\n    _md.prototype.localDevices = null;\n    _md.prototype.localStream = null;\n\n    //events\n    _md.prototype.DEVICES_UPDATED = \"devicesUpdated\";\n    _md.prototype.ON_LOCAL_STREAM = \"onLocalStream\";\n\n    /* PUBLIC */\n\n    _md.prototype.getUserMedia = function (constraints, cbSuccess, cbFail) {\n      if (!constraints) constraints = { audio: true, video: true };\n      //return promise\n      var own = this;\n      return navigator.mediaDevices.getUserMedia(constraints).then((str) => {\n        own.localStream = str;\n        own.emit(own.ON_LOCAL_STREAM, str);\n        return str;\n      });\n      /* .catch(err => { \n              console.log('Could not get Media: ', err);\n              throw err;\n          }); */\n    };\n\n    _md.prototype.getLocalDevices = function () {\n      if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        console.log(\n          \"Error: Could not get list of media devices!  This might not be supported by this browser.\"\n        );\n        return;\n      }\n      let d = navigator.mediaDevices.enumerateDevices();\n      return d;\n    };\n\n    /* PRIVATE */\n\n    _md.prototype.updateDevices = function (list) {\n      console.log(\"*media*  updateDevices \", list);\n      if (arguments.length == 0) return;\n      //set local list. dispatch event that list is updated.\n      let items = { audioin: [], videoin: [] };\n\n      list.forEach((device) => {\n        //console.log('device: ',device);\n        if (device.deviceId == \"default\") {\n          if (!items.defaults) items.defaults = [];\n          items.defaults.push(device);\n          return;\n        }\n        switch (device.kind) {\n          case \"audioinput\":\n            if (device.deviceId != \"default\") {\n              items.audioin.push(device);\n            }\n            break;\n          case \"videoinput\":\n            if (device.deviceId != \"default\") {\n              items.videoin.push(device);\n            }\n            break;\n        }\n      });\n      //console.log('Items list: ',items);\n      this.localDevices = items;\n      this.emit(this.DEVICES_UPDATED, this.localDevices);\n    };\n\n    //UTILS\n\n    /* EVENTS */\n\n    _md.prototype.on = function (sEvent, cbFunc) {\n      //console.log('*p2group*  on ',sEvent,', func: '+cbFunc);\n      if (!sEvent || !cbFunc) {\n        console.log('error:  missing arguments for \"on\" event.');\n        return false;\n      }\n      //if event does not exist create it and give it an array for listeners.\n      if (!this.evtListeners[sEvent]) this.evtListeners[sEvent] = [];\n      //add listener to event.\n      this.evtListeners[sEvent].push(cbFunc);\n    };\n    _md.prototype.off = function (sEvent, cbFunc) {\n      if (!this.evtListeners.hasOwnProperty(sEvent)) return false; //end\n\n      let index = this.evtListeners[sEvent].indexOf(cbFunc);\n      if (index != -1) {\n        this.evtListeners[sEvent].splice(index, 1);\n        return true; //else end here.\n      }\n      return false; //else end here.\n    };\n\n    _md.prototype.emit = function (sEvent, data) {\n      let handlers = this.evtListeners[sEvent];\n      if (!!handlers) {\n        let l = handlers.length,\n          i;\n        for (i = 0; i < l; i++) {\n          let item = handlers[i];\n          item.apply(this, [{ type: sEvent, data: data }]);\n        }\n      }\n    };\n\n    console.log(\"$xirsys.media Loaded Successfuly!!!\");\n    _md = null;\n\n    //Ice\n\n    var _ice = ($xirsys.ice = function (apiUrl, info) {\n      if (!info) info = {};\n      this.info = info;\n      this.apiUrl = !!apiUrl ? apiUrl : \"/webrtc\";\n      this.evtListeners = {};\n\n      //path to channel we are sending data to.\n      this.channelPath = !!info.channel ? this.cleanChPath(info.channel) : \"\";\n\n      this.iceServers = null;\n      if (!!this.apiUrl) {\n        if (this.info.ident && this.info.secret) {\n          this.doICE(this.info.ident, this.info.secret); //first get our token.\n        } else {\n          this.doICE();\n        }\n      }\n    });\n\n    _ice.prototype.onICEList = \"onICEList\";\n\n    _ice.prototype.doICE = function (ident, secret) {\n      console.log(\"*ice*  doICE: \", this.apiUrl + \"/_turn\" + this.channelPath);\n      var own = this;\n      var xhr = new XMLHttpRequest();\n      xhr.onreadystatechange = function ($evt) {\n        if (xhr.readyState == 4 && xhr.status == 200) {\n          var res = JSON.parse(xhr.responseText);\n          console.log(\"*ice*  response: \", res);\n          own.iceServers = own.filterPaths(res.v.iceServers);\n\n          own.emit(own.onICEList);\n        }\n      };\n      var path = this.apiUrl + \"/_turn/\" + this.channelPath;\n      xhr.open(\"PUT\", path, true);\n      if (ident && secret)\n        xhr.setRequestHeader(\n          \"Authorization\",\n          \"Basic \" + btoa(`${ident}:${secret}`)\n        );\n      xhr.send();\n    };\n\n    //check for depricated RTCIceServer \"url\" property, needs to be \"urls\" now.\n    _ice.prototype.filterPaths = function (arr) {\n      var l = arr.length,\n        i;\n      var a = [];\n      for (i = 0; i < l; i++) {\n        var item = arr[i];\n        var v = item.url;\n        if (!!v) {\n          item.urls = v;\n          delete item.url;\n        }\n        a.push(item);\n      }\n      return a;\n    };\n\n    //formats the custom channel path how we need it.\n    _ice.prototype.cleanChPath = function (path) {\n      //has slash at front\n      console.log(\"cleanChPath path recv: \" + path);\n      if (path.indexOf(\"/\") != 0) path = \"/\" + path;\n      if (path.lastIndexOf(\"/\") == path.length - 1)\n        path = path.substr(0, path.lastIndexOf(\"/\"));\n      console.log(\"cleanChPath new path: \" + path);\n      return path;\n    };\n\n    _ice.prototype.on = function (sEvent, cbFunc) {\n      //console.log('*ice*  on ',sEvent);\n      if (!sEvent || !cbFunc) {\n        console.log(\"error:  missing arguments for on event.\");\n        return false;\n      }\n      if (!this.evtListeners[sEvent]) this.evtListeners[sEvent] = [];\n      this.evtListeners[sEvent].push(cbFunc);\n    };\n    _ice.prototype.off = function (sEvent, cbFunc) {\n      if (!this.evtListeners.hasOwnProperty(sEvent)) return false; //end\n\n      var index = this.evtListeners[sEvent].indexOf(cbFunc);\n      if (index != -1) {\n        this.evtListeners[sEvent].splice(index, 1);\n        return true; //else end here.\n      }\n      return false; //else end here.\n    };\n\n    _ice.prototype.emit = function (sEvent, data) {\n      var handlers = this.evtListeners[sEvent];\n      if (!!handlers) {\n        var l = handlers.length;\n        for (var i = 0; i < l; i++) {\n          var item = handlers[i];\n          item.apply(this, [{ type: this.onICEList }]);\n        }\n      }\n    };\n\n    console.log(\"$xirsys.ice Loaded Successfuly!!!\");\n    _ice = null;\n\n    // Signal\n\n    var _sig = ($xirsys.signal = function (apiUrl, userName, info) {\n      if (!info) info = {};\n      this.info = info;\n      //internal values\n      this.sig = null; //local signal object.\n      this.tmpToken = null; //authorized token for signal calls\n      this.sigHostPath = null; //full authorized path to signaling service.\n      this.pendListeners = []; //event listener - hold until init.\n      this.heartbeat = null; //interval that keeps the signal open.\n      this.evtListeners = {};\n\n      //path to channel we are sending data to.\n      //this.channelPath = !!info.channel ? this.cleanChPath(info.channel) : '';\n\n      this.userName = !!userName ? userName : null;\n      this.apiUrl = !!apiUrl ? apiUrl : \"/webrtc\";\n      //console.log('*signal*  constructed');\n      this.connectTo(!!info.channel ? info.channel : \"\");\n    });\n\n    _sig.prototype.ver = \"v2\";\n    _sig.prototype.keepAliveInt = 800;\n    _sig.prototype.connected = false;\n\n    _sig.prototype.close = function () {\n      console.log(\"close \", this.sig);\n      if (this.heartbeat) this.stopHeart();\n      if (this.sig) this.sig.close();\n    };\n\n    _sig.prototype.connectTo = function (channel) {\n      this.channelPath = !!channel ? this.cleanChPath(channel) : \"\";\n      console.log(\"connectTo: \", this.channelPath);\n      //if connected stop current, then do new.\n      if (!!this.sig) {\n        this.close();\n        var own = this;\n        setTimeout(() => {\n          own.doToken();\n        }, 800);\n      } else if (!!this.apiUrl) {\n        //!!this.userName &&\n        if (this.info.ident && this.info.secret) {\n          this.doToken(this.info.ident, this.info.secret); //first get our token.\n        } else {\n          this.doToken();\n        }\n      } else {\n        console.log(\"Error: Could connect signal!\");\n      }\n      return true;\n    };\n\n    _sig.prototype.doToken = function (ident, secret) {\n      var path =\n        this.apiUrl + \"/_token\" + this.channelPath + \"?k=\" + this.userName;\n      console.log(\"*signal*  PUT doToken to \" + path);\n      var own = this;\n      var _headers = {};\n      if (ident && secret) {\n        _headers[\"Authorization\"] = \"Basic \" + btoa(ident + \":\" + secret);\n      }\n      $.ajax({\n        url: path,\n        type: \"PUT\",\n        dataType: \"json\",\n        headers: _headers,\n        error: function (data) {\n          console.log(\"*signal*  error: \", data);\n        },\n        success: function (data) {\n          own.tmpToken = data.v;\n          if (own.tmpToken == \"no_namespace\") {\n            console.log(\"*signal*  fail: \", own.tmpToken);\n            return;\n          }\n          console.log(\"*signal*  token: \", own.tmpToken);\n          if (own.info.ident && own.info.secret) {\n            own.doSignal(own.info.ident, own.info.secret); //first get our token.\n          } else {\n            own.doSignal();\n          }\n        },\n      });\n    };\n\n    _sig.prototype.doSignal = function (ident, secret) {\n      console.log(\n        \"*signal*  GET doSignal to \" +\n          this.apiUrl +\n          \"/_host\" +\n          this.channelPath +\n          \"?type=signal&k=\" +\n          this.userName\n      );\n      var own = this;\n      var path = this.info.channel\n        ? this.apiUrl +\n          \"/_host\" +\n          this.channelPath +\n          \"?type=signal&k=\" +\n          this.userName\n        : this.apiUrl + \"/_host?type=signal&k=\" + this.userName;\n      var _headers = {};\n      if (ident && secret) {\n        _headers[\"Authorization\"] = \"Basic \" + btoa(ident + \":\" + secret);\n      }\n      $.ajax({\n        url: path,\n        type: \"GET\",\n        dataType: \"json\",\n        headers: _headers,\n        error: function (data) {\n          console.log(\"*signal*  error: \", data);\n        },\n        success: function (data) {\n          own.host = data.v + \"/\" + own.ver + \"/\" + own.tmpToken;\n          console.log(\"KKKKKKKKK \", data);\n          if (data.randomUser) {\n            own.randomUser = data.randomUser;\n            setRandomUser(data.randomUser);\n          }\n\n          if (data.users) own.users = data.users;\n\n          console.log(\"signal host: \", own.host);\n          own.setupSocket();\n        },\n      });\n    };\n\n    //setup socket to signaling server.\n    _sig.prototype.setupSocket = function () {\n      console.log(\"*signal*  setupSocket to \" + this.host);\n      var own = this;\n      this.sig = new WebSocket(this.host);\n      //notify when connection is open\n      this.sig.addEventListener(\"open\", (evt) => {\n        own.startHeart();\n        own.connected = true;\n      });\n      //notify when connection closed\n      this.sig.addEventListener(\"close\", (evt) => {\n        if (this.heartbeat) own.stopHeart();\n        own.connected = false;\n        this.sig = null;\n      });\n\n      //add pending listeners to signaling object.\n      var l = this.pendListeners.length;\n      if (l > 0) {\n        for (var i = 0; i < l; i++) {\n          var item = this.pendListeners[i];\n          this.on(item.event, item.f);\n        }\n        this.pendListeners = [];\n      }\n      //notify when a message is received from signal network.\n      this.sig.addEventListener(\"message\", (msg) => {\n        var pkt = JSON.parse(msg.data);\n        console.log(\"*signal*  signal message! \", pkt);\n        var payload = pkt.p; //the actual message data sent\n        var meta = pkt.m; //meta object\n        var msgEvent = meta.o; //event label of message\n        var toPeer = meta.t; //msg to user (if private msg)\n        var fromPeer = meta.f; //msg from user\n        if (!!fromPeer) {\n          //remove the peer path to display just the name not path.\n          var p = fromPeer.split(\"/\");\n          fromPeer = p[p.length - 1];\n        }\n        switch (msgEvent) {\n          //first connect, list of all peers connected.\n          case \"peers\":\n            //this is first call when you connect,\n            //  so we can check for channelPath here dynamically.\n            var sysNum = meta.f.lastIndexOf(\"__sys__\");\n            if (sysNum > -1 && !this.channelPath) {\n              own.channelPath = meta.f.substring(0, sysNum); //save message path for sending.\n              console.log(\"*signal*  channelPath \", this.channelPath);\n            }\n            //setUsers(payload.users);\n            break;\n          //new peer connected\n          case \"peer_connected\":\n            //addUser(fromPeer);\n            break;\n          //peer left.\n          case \"peer_removed\":\n            //removeUser(fromPeer);\n            break;\n          //message received. Call to display.\n          case \"message\":\n            //onUserMsg(payload.msg, fromPeer, toPeer);\n            var data = payload.msg;\n            data.f = fromPeer;\n            if (\n              data.type == \"candidate\" ||\n              data.type == \"offer\" ||\n              data.type == \"answer\" ||\n              data.type == \"custom\"\n            ) {\n              own.emit(data.type, data);\n            }\n            break;\n        }\n        own.emit(\"message\", msg.data);\n      });\n      //console.log('sig:  ',this.sig);\n    };\n    // User event, sends user message.\n    _sig.prototype.sendMessage = function (msg, toPeer, info) {\n      if (!info) info = {};\n      console.log(\n        \"*signal*  sendMessage: \",\n        msg,\n        \", to: \",\n        toPeer,\n        \" info: \",\n        info\n      );\n      if (msg == undefined || msg.length < 1) return;\n      var pkt = {\n        t: \"u\", // user message service\n        m: {\n          f: this.channelPath + this.userName,\n          o: !!info.m_event ? info.m_event : \"message\",\n        },\n        p: { msg: msg },\n      };\n      //if its to a peer, add direct message var (t) to meta object.\n      if (!!toPeer) pkt.m.t = toPeer;\n      //console.log('*signal*  sendMessage pkt: ',pkt);\n      this.sig.send(JSON.stringify(pkt));\n\n      return pkt;\n    };\n\n    //formats the custom channel path how we need it.\n    _sig.prototype.cleanChPath = function (path) {\n      //has slash at front\n      if (path.indexOf(\"/\") != 0) path = \"/\" + path;\n      if (path.lastIndexOf(\"/\") == path.length - 1)\n        path = path.substr(0, path.lastIndexOf(\"/\"));\n      //console.log('cleanChPath new path: '+path);\n      return path;\n    };\n\n    //Keeps pinging signal server to keep connection alive.\n    _sig.prototype.startHeart = function () {\n      //console.log('*signal*  startHeart ',this.keepAliveInt);\n      if (!!this.heartbeat) clearInterval(this.heartbeat);\n      var own = this;\n      this.heartbeat = setInterval(function () {\n        own.sig.send(\"ping\");\n      }, $xirsys.signal.keepAliveInt);\n    };\n    _sig.prototype.stopHeart = function () {\n      clearInterval(this.heartbeat);\n      this.heartbeat = null;\n      //this.sig = null;\n      console.log(\"signal closed!\");\n    };\n\n    //events\n    _sig.prototype.on = function (sEvent, cbFunc) {\n      //console.log('*signal*  on ',sEvent,', func: '+cbFunc);\n      if (!sEvent || !cbFunc) {\n        console.log('error:  missing arguments for \"on\" event.');\n        return false;\n      }\n      //if event does not exist create it and give it an array for listeners.\n      if (!this.evtListeners[sEvent]) this.evtListeners[sEvent] = [];\n      //add listener to event.\n      this.evtListeners[sEvent].push(cbFunc);\n    };\n    _sig.prototype.off = function (sEvent, cbFunc) {\n      if (!this.evtListeners.hasOwnProperty(sEvent)) return false; //end\n\n      var index = this.evtListeners[sEvent].indexOf(cbFunc);\n      if (index != -1) {\n        this.evtListeners[sEvent].splice(index, 1);\n        return true; //else end here.\n      }\n      return false; //else end here.\n    };\n\n    _sig.prototype.emit = function (sEvent, data) {\n      //console.log('*signal*  emit ',sEvent,', func: '+data);\n      var handlers = this.evtListeners[sEvent];\n      if (!!handlers) {\n        var l = handlers.length;\n        for (var i = 0; i < l; i++) {\n          var item = handlers[i];\n          item.apply(this, [{ type: sEvent, data: data }]);\n        }\n      }\n    };\n    console.log(\"$xirsys.signal Loaded Successfuly!!!\");\n    _sig = null;\n\n    // p2p\n\n    var _p2p = ($xirsys.p2p = function (signal, mediaStream, servers, info) {\n      if (!info) info = {};\n      //info can have TURN only filter.\n      console.log(\n        \"*p2p*  servers: \",\n        servers,\n        \", mediaStream: \",\n        mediaStream,\n        \", sig: \",\n        signal,\n        \", info: \",\n        info\n      );\n      this.evtListeners = {};\n      this.pc = null; //peer connection\n\n      var own = this;\n      this.sig = signal;\n      if (!!this.sig) {\n        this.sig.on(\"candidate\", (evt) => {\n          own.receiveCandidate(evt);\n        });\n        this.sig.on(\"offer\", (evt) => {\n          own.receiveOffer(evt);\n        });\n        this.sig.on(\"answer\", (evt) => {\n          own.receiveAnswer(evt);\n        });\n      }\n      this.servers = !!servers ? servers : {};\n      this.forceTurn = info.forceTurn != null ? info.forceTurn : false;\n      this.stream = mediaStream;\n      this.remotePeerID = null;\n      this.remoteStreams = {};\n\n      this.isCaller = null; //true / false\n      this.autoAnswer = info.autoAnswer != null ? info.autoAnswer : true;\n    });\n\n    _p2p.prototype.peerConnSuccess = \"peer.connect.success\";\n    _p2p.prototype.peerConnRequest = \"peer.connect.request\";\n    _p2p.prototype.iceDisconnected = \"peer.connect.disconnected\";\n\n    _p2p.prototype.close = function () {\n      if (this.pc) {\n        this.pc.close();\n      }\n      this.remoteStreams = {};\n      this.remotePeerID = null;\n      this.isCaller = null;\n    };\n    //used to update the media and renegociate p2p connection.\n    _p2p.prototype.updateMediaStream = function (mediaStream) {\n      console.log(\"*p2p*  updateMediaStream \", mediaStream);\n\n      this.stream = mediaStream;\n      if (!!this.pc && this.stream) {\n        this.isCaller = true;\n        const own = this;\n        this.pc.addStream(this.stream);\n        this.pc\n          .createOffer()\n          .then((desc) => {\n            own.setLocalAndSendMessage(desc);\n          }) // success\n          .catch((err) => {\n            own.onCreateSessionDescriptionError(err);\n          }); // error\n      }\n      return true;\n    };\n    //calls peer @custID and estblishes a p2p connection.\n    _p2p.prototype.callPeer = function (custID) {\n      console.log(\"*p2p*  callPeer \", custID);\n      if (this.createPeerConnection() && this.stream) {\n        //this flag tells our code we are doing the calling.\n        this.isCaller = true;\n        const own = this;\n        this.remotePeerID = custID;\n        this.pc.addStream(this.stream);\n        this.pc\n          .createOffer()\n          .then((desc) => {\n            own.setLocalAndSendMessage(desc);\n          }) // success\n          .catch((err) => {\n            own.onCreateSessionDescriptionError(err);\n          }); // error\n      }\n    };\n\n    _p2p.prototype.receiveCandidate = function (evt) {\n      if (!this.pc) return false;\n      var iceCandidate = evt.data;\n      //console.log('*p2p*  receiveCandidate ',iceCandidate);\n      var rtcIceCandidate = new RTCIceCandidate(iceCandidate);\n      this.pc.addIceCandidate(rtcIceCandidate);\n    };\n\n    //user calles to accept offer when this has autoAnswer false\n    _p2p.prototype.acceptRequest = function (offer) {\n      //Pass offer to method with true which tells method offer was accepted.\n      this.receiveOffer(offer, true);\n    };\n\n    _p2p.prototype.receiveOffer = function (evt, isVerfied) {\n      var verified = isVerfied == true;\n      var desc = evt.data;\n      console.log(\n        \"*p2p*  receiveOffer \",\n        desc,\n        \" remotePeerID = \",\n        this.remotePeerID,\n        \"autoAnswer\",\n        this.autoAnswer\n      );\n      //if autoAnser is false, and this has not been verified, stop and emit request event.\n      if (!this.autoAnswer && !verified) {\n        console.log(\"needs verification!\");\n        this.emit(this.peerConnRequest, evt.data);\n        return;\n      }\n      //if autoAnser is false and has been verfied, OR autoAnswer is true then connect us.\n      if (!this.remotePeerID && !!desc.f) this.remotePeerID = desc.f;\n      console.log(\"*p2p*  !pc \", this.pc, \", !iscaller: \", this.isCaller);\n      if (!this.pc && !this.isCaller) {\n        if (this.createPeerConnection() && this.stream) {\n          this.pc.addStream(this.stream);\n        }\n      }\n      var own = this;\n\n      try {\n        this.pc.setRemoteDescription(new RTCSessionDescription(desc));\n      } catch (e) {\n        console.error(\"**P2p** setRemoteDescription offer ,\", e);\n      }\n\n      this.pc\n        .createAnswer()\n        .then((desc) => {\n          own.setLocalAndSendMessage(desc);\n        }) // success\n        .catch((err) => {\n          own.onCreateSessionDescriptionError(err);\n        }); // error\n    };\n\n    _p2p.prototype.receiveAnswer = function (evt) {\n      var desc = evt.data;\n      console.log(\"*p2p*  receiveAnswer \", desc);\n      if (this.remotePeerID != desc.f) return; //not the droid were looking for.\n      try {\n        this.pc.setRemoteDescription(new RTCSessionDescription(desc));\n      } catch (e) {\n        console.error(\"**P2p** setRemoteDescription answer ,\", e);\n      }\n    };\n\n    _p2p.prototype.createPeerConnection = function () {\n      console.log(\"*p2p*  createPeerConnection \");\n      //if(!!this.pc) return true;\n      try {\n        var own = this;\n        console.log(\"RTCPeerConnection servers:  \", this.servers);\n        this.pc = new RTCPeerConnection(this.servers);\n        this.pc.onicecandidate = function (evt) {\n          //send to peer\n          var cand = evt.candidate;\n          if (!cand) return;\n          if (own.forceTurn && cand.candidate.indexOf(\"typ relay\") == -1) {\n            cand = null;\n          } else {\n            //console.log('Is Turn: ',own.forceTurn,' Candidate: ',cand);\n            own.sig.sendMessage(\n              {\n                type: \"candidate\",\n                candidate: cand.candidate,\n                sdpMid: cand.sdpMid,\n                sdpMLineIndex: cand.sdpMLineIndex,\n              },\n              own.remotePeerID\n            );\n          }\n        };\n        this.pc.onaddstream = (evt) => {\n          console.log(\"*p2p*  onaddstream \", evt);\n          own.addRemoteStream(evt.stream); //remoteStreams\n        };\n        this.pc.onremovestream = (evt) =>\n          console.log(\"*p2p*  onremovestream \", evt);\n        this.pc.onconnectionstatechange = (evt) =>\n          console.log(\n            \"*p2p*  onconnectionstatechange: \" + own.pc.connectionState\n          );\n        this.pc.oniceconnectionstatechange = (evt) => {\n          console.log(\n            \"*p2p*  oniceconnectionstatechange: \" + own.pc.iceConnectionState\n          );\n\n          switch (own.pc.iceConnectionState) {\n            case \"checking\":\n              break;\n            case \"connected\":\n              break;\n            case \"disconnected\":\n              own.emit(own.iceDisconnected, own.remotePeerID);\n              break;\n            case \"failed\":\n              break;\n            case \"closed\":\n              own.pc = null;\n              console.log(\"pc: \", own.pc);\n              break;\n          }\n        };\n        return true;\n      } catch (e) {\n        console.log(\"Failed to create PeerConnection, exception: \" + e.message);\n        return false;\n      }\n    };\n\n    _p2p.prototype.hangup = function (callId) {\n      console.log(\"*p2p*  hangup\", callId);\n      //var stream = this.remoteStreams[callId];\n      this.pc.close();\n      this.remoteStreams[callId] = null;\n      this.remotePeerID = null;\n      this.isCaller = false;\n      //if no streams close and nulify pc.\n      //this.pc = null;\n    };\n\n    _p2p.prototype.addRemoteStream = function (remoteStream) {\n      this.remoteStreams[this.remotePeerID] = remoteStream;\n      this.emit(this.peerConnSuccess, this.remotePeerID);\n      this.isCaller = false;\n    };\n\n    _p2p.prototype.getLiveStream = function (remotePeerID) {\n      return this.remoteStreams[remotePeerID];\n    };\n\n    _p2p.prototype.setLocalAndSendMessage = function (sessionDescription) {\n      console.log(\n        \"*p2p*  setLocalAndSendMessage sending message\",\n        sessionDescription\n      );\n      this.pc.setLocalDescription(sessionDescription);\n      //sendMessage(sessionDescription);\n      console.log(\"sendMessage for: \", this.remotePeerID);\n      this.sig.sendMessage(sessionDescription, this.remotePeerID);\n    };\n\n    _p2p.prototype.onCreateSessionDescriptionError = function (error) {\n      console.log(\"Failed to create session description: \", error);\n    };\n\n    /* EVENTS */\n\n    _p2p.prototype.on = function (sEvent, cbFunc) {\n      //console.log('*p2p*  on ',sEvent,', func: '+cbFunc);\n      if (!sEvent || !cbFunc) {\n        console.log(\"error:  missing arguments for on event.\");\n        return false;\n      }\n      if (!this.evtListeners[sEvent]) this.evtListeners[sEvent] = [];\n      this.evtListeners[sEvent].push(cbFunc);\n    };\n    _p2p.prototype.off = function (sEvent, cbFunc) {\n      console.log(\"off\");\n      this.evtListeners.push(cbFunc);\n    };\n\n    _p2p.prototype.emit = function (sEvent, data) {\n      var handlers = this.evtListeners[sEvent];\n      if (!!handlers) {\n        var l = handlers.length;\n        for (var i = 0; i < l; i++) {\n          var item = handlers[i];\n          item.apply(this, [{ type: sEvent, data: data }]);\n        }\n      }\n    };\n\n    console.log(\"$xirsys.p2p Loaded Successfuly!!!\");\n    _p2p = null;\n  }, []);\n\n  return { $xirsys };\n}\n\nexport default Xirsys;\n","import $ from \"jquery\";\nimport Xirsys from \"./Xirsys\";\nimport { useState, useEffect } from \"react\";\n\nfunction Main() {\n  const location = {};\n\n  //custom: check URL for \"ch\" var, and set the channel accourdingly\n  var channelPath = \"\"; //set this variable to specify a channel path\n  var ch = decodeURI(\n    (RegExp(\"ch\" + \"=\" + \"(.+?)(&|$)\").exec(location.search) || [, null])[1]\n  );\n  if (ch != \"null\") channelPath = ch;\n  console.log(\"channel path: \", channelPath);\n\n  var mediaConstraints = {\n    audio: true,\n  };\n\n  const [lstream, setLStream] = useState(null);\n  const [rstream, setRStream] = useState(null);\n  const [username, setUsername] = useState(null);\n  const [remoteCallID, setRemoteCallID] = useState(null);\n\n  const [peer, setPeer] = useState(null);\n  const [sig, setSig] = useState(null);\n  const [media, setMedia] = useState(null);\n  const [ice, setIce] = useState(null);\n\n  const [call, setCall] = useState(false);\n  const [inCall, setInCall] = useState(false);\n\n  const { $xirsys } = Xirsys(setRemoteCallID);\n\n  useEffect(() => {\n    if (lstream) {\n      //create signal if null\n      if (!sig)\n        setSig(\n          new $xirsys.signal(\"/webrtc\", username, { channel: channelPath })\n        );\n      //if the peer is created, update our media\n      if (!!peer) peer.updateMediaStream(lstream);\n    }\n  }, [lstream]);\n\n  useEffect(() => {\n    if (peer) {\n      peer.on(peer.peerConnSuccess, onStartCall);\n      console.log(\"peer \", peer);\n    }\n  }, [peer]);\n\n  useEffect(() => {\n    if (call) {\n      callRemotePeer();\n      setCall(false);\n    }\n  }, [call]);\n\n  useEffect(() => {\n    if (sig) doSignal();\n  }, [sig]);\n\n  useEffect(() => {\n    if (media) getMyMedia();\n  }, [media]);\n\n  useEffect(() => {\n    if (ice) ice.on(ice.onICEList, onICE);\n  }, [ice]);\n\n  useEffect(() => {\n    console.log(\"remote Id == \", remoteCallID);\n\n    if (sig) doSignal();\n  }, [remoteCallID]);\n  //if there is no remoteCallID show sharable link to call user.\n\n  function callRemotePeer() {\n    if (!!remoteCallID) {\n      console.log(\"Calling \" + remoteCallID);\n      peer.callPeer(remoteCallID);\n    } else {\n      console.log(\"Error\", \"A remote peer was not found!\");\n    }\n  }\n\n  // Get Xirsys ICE (STUN/TURN)\n  function doICE() {\n    console.log(\"doICE \");\n    if (!ice) {\n      setIce(new $xirsys.ice(\"/webrtc\", { channel: channelPath }));\n      //   ice.on(ice.onICEList, onICE);\n    }\n  }\n\n  function onICE(evt) {\n    console.log(\"onICE \", evt);\n    if (evt.type == ice.onICEList) {\n      //   getMyMedia();\n      setMedia(new $xirsys.media());\n    }\n  }\n\n  //Get local user media\n  function getMyMedia() {\n    console.log(\"getMyMedia()\");\n    //setup media\n    // if (!media) {\n    //   media = new $xirsys.media();\n    media.on(media.DEVICES_UPDATED, onMediaDevices); //returns list of media devices on local user machine.\n    media.on(media.ON_LOCAL_STREAM, onMediaDevices); //returns a/v stream of local user.\n    // }\n    //gets stream object of local users a/v\n    media\n      .getUserMedia(mediaConstraints)\n      .then((str) => {\n        console.log(\"*main*  getUser Media stream: \", str);\n        setLocalStream(str);\n        //create signal if null\n        // if (!sig) doSignal();\n        // //if the peer is created, update our media\n        // if (!!peer) peer.updateMediaStream(lstream);\n      })\n      .catch((err) => {\n        console.log(\"Could not get Media: \", err);\n        alert(\"Could not get Media!! Please check your camera and mic.\");\n      });\n  }\n\n  //Get Xirsys Signaling service\n  function doSignal() {\n    sig.on(\"message\", (msg) => {\n      let pkt = JSON.parse(msg.data);\n\n      console.log(\"message log ,\", msg, $xirsys);\n\n      let payload = pkt.p; //the actual message data sent\n      let meta = pkt.m; //meta object\n      let msgEvent = meta.o; //event label of message\n      let toPeer = meta.t; //msg to user (if private msg)\n      let fromPeer = meta.f; //msg from user\n      //remove the peer path to display just the name not path.\n      if (!!fromPeer) {\n        let p = fromPeer.split(\"/\");\n        fromPeer = p[p.length - 1];\n      }\n      switch (msgEvent) {\n        //first Connect Success!, list of all peers connected.\n        case \"peers\":\n          //this is first call when you connect,\n          onReady();\n          // if we are connecting to a remote user and remote\n          // user id is found in the list then initiate call\n          if (!!remoteCallID) {\n            let users = payload.users;\n            if (users.indexOf(remoteCallID) > -1) {\n              setCall(true);\n            }\n          }\n          break;\n        //peer gone.\n        case \"peer_removed\":\n          if (fromPeer == remoteCallID) onStopCall();\n          break;\n\n        // new peer connected\n        //case \"peer_connected\":\n        // \taddUser(fromPeer);\n        // \tbreak;\n        // message received. Call to display.\n        //case 'message':\n        // \tonUserMsg(payload.msg, fromPeer, toPeer);\n        // \tbreak;\n      }\n    });\n  }\n\n  //Ready - We have our ICE servers, our Media and our Signaling.\n  function onReady() {\n    console.log(\"* onReady!\");\n    // setup peer connector, pass signal, our media and iceServers list.\n    let isTURN = getURLParameter(\"isTURN\") == \"true\"; //get force turn var.\n    console.log(\"isTURN \", isTURN);\n    setPeer(\n      new $xirsys.p2p(\n        sig,\n        lstream,\n        !ice ? {} : { iceServers: ice.iceServers },\n        { forceTurn: isTURN }\n      )\n    );\n    //add listener when a call is started.\n  }\n  // A peer call started udpate the UI to show remote video.\n  function onStartCall(evt) {\n    console.log(\"*main*  onStartCall \", evt);\n    let remoteId = evt.data;\n    console.log(\"peer scall \", peer);\n    setRemoteStream(peer.getLiveStream(remoteId));\n    //   shareTitleEl.innerHTML = \"In call with user:\";\n    setRemoteCallID(remoteId);\n    setInCall(true);\n  }\n\n  function onStopCall() {\n    console.log(\"*main*  onStopCall \");\n    if (inCall) {\n      peer.hangup(remoteCallID);\n    }\n    setInCall(false);\n    setRemoteCallID(null);\n    setIce(null);\n    setPeer(null);\n    setMedia(null);\n    setSig(null);\n  }\n\n  /* UI METHODS */\n\n  //sets local user media to video object.\n  function setLocalStream(str) {\n    console.log(\"*main*  setLocalStream & Video obj \", str);\n    // localStream = str;\n    setLStream(str);\n    // localVideoEl.srcObject = str;\n  }\n  //sets remote user media to video object.\n  function setRemoteStream(str) {\n    console.log(\"*main*  setRemoteStream & Video obj \", str);\n    // remoteStream = str;\n    setRStream(str);\n    // remoteVideoEl.srcObject = str;\n  }\n  //update the list of media sources on UI\n  function onMediaDevices(e) {\n    console.log(\"*main*  onMediaDevices: \", e, \" data: \", e.data);\n    switch (e.type) {\n      case media.DEVICES_UPDATED:\n        updateDevices(e.data);\n        break;\n      case media.ON_LOCAL_STREAM:\n        //update list with selected.\n        setSelectedDevices(e.data.getTracks());\n        break;\n    }\n  }\n\n  function updateDevices(devices) {\n    const mics = devices.audioin,\n      cams = devices.videoin;\n    console.log(\"*main*  updateDevices - mics:\", mics, \", cams:\", cams);\n    const camList = $(\"#ctrlMenu #camList\"),\n      micList = $(\"#ctrlMenu #micList\");\n    //camToggle = $('#ctrlMenu #camToggle'),\n    //micToggle = $('#ctrlMenu #micToggle');\n\n    micList.empty();\n    mics.forEach((device) => {\n      micList.append(\n        '<li><a id=\"' +\n          device.deviceId +\n          '\" data-group-id=\"' +\n          device.groupId +\n          '\" class=\"btn\" role=\"button\">' +\n          device.label +\n          \"</a></li>\"\n      );\n    });\n\n    camList.empty();\n    cams.forEach((device) => {\n      camList.append(\n        '<li><a id=\"' +\n          device.deviceId +\n          '\" data-group-id=\"' +\n          device.groupId +\n          '\" class=\"btn\" role=\"button\">' +\n          device.label +\n          \"</a></li>\"\n      );\n    });\n  }\n\n  function setSelectedDevices(devices) {\n    console.log(\"*main*  setSelectedDevices: \", devices);\n    //console.log('- video: ',devices.getVideoTracks() );\n    devices.forEach((device) => {\n      switch (device.kind) {\n        case \"audio\":\n          console.log(\"- audio toggel: \", device);\n          $(\"#ctrlMenu #micToggle\").html(\n            device.label.substr(0, 20) + '<span class=\"caret\"></span>'\n          );\n          break;\n        case \"video\":\n          console.log(\"- video toggel: \", device);\n          $(\"#ctrlMenu #camToggle\").html(\n            device.label.substr(0, 20) + '<span class=\"caret\"></span>'\n          );\n          break;\n      }\n    });\n  }\n\n  /* TOOLS */\n\n  function hasMedia(label, tracks) {\n    console.log(\"tracks: \", tracks, \", label: \", label);\n    let l = tracks.length,\n      i,\n      hasIt = false;\n    for (i = 0; i < l; i++) {\n      let track = tracks[i];\n      if (track.label.indexOf(label) > -1) {\n        hasIt = true;\n        break;\n      }\n    }\n    return hasIt;\n  }\n\n  //gets URL parameters\n  function getURLParameter(name) {\n    var url_string = window.location.href;\n    var url = new URL(url_string);\n    var c = url.searchParams.get(name);\n\n    return c ? c : null;\n  }\n  //makes unique userid\n  function guid(s = \"user\") {\n    function s4() {\n      return Math.floor((1 + Math.random()) * 0x10000)\n        .toString(16)\n        .substring(1);\n    }\n    return s + s4() + s4();\n  }\n\n  const onLoad = () => {\n    console.log(\"pretty loaded!!\");\n    setUsername(guid()); //create random local username\n    let urlName = getURLParameter(\"callid\"); //get call id if exists from url\n    if (!!urlName) {\n      setRemoteCallID(urlName);\n    }\n\n    //get Xirsys service\n    doICE();\n  };\n\n  return { onLoad, lstream, rstream, setLStream, setRStream, onStopCall };\n}\nexport default Main;\n\n// export const stream = { localStream, remoteStream };\n","import React, { useEffect, useState } from \"react\";\nimport Loader from \"react-loader-spinner\";\nimport WaveAudio from \"./WaveAudio\";\n\nimport Main from \"../hooks/Main1\";\n\nfunction Audio({ type = 0, answer }) {\n  const { onLoad, lstream, rstream, setRStream, setLStream, onStopCall } =\n    Main();\n\n  useEffect(() => {\n    if (type === 0) {\n      setLStream(null);\n      setRStream(null);\n      stopAudioOnly(lstream);\n      stopAudioOnly(rstream);\n      onStopCall();\n    } else if (type === 1) {\n      onLoad();\n    }\n\n    if (rstream) {\n      answer();\n    }\n  }, [type, rstream]);\n\n  return type === 1 ? (\n    <Loader\n      type=\"ThreeDots\"\n      color=\"rgba(102, 193, 113, 1)\"\n      height={100}\n      width={100}\n    />\n  ) : type === 2 ? (\n    <WaveAudio stream={rstream} lstream={lstream} />\n  ) : (\n    <div></div>\n  );\n}\n\nexport default Audio;\n\nfunction stopAudioOnly(stream) {\n  if (stream)\n    stream.getTracks().forEach(function (track) {\n      if (track.readyState === \"live\" && track.kind === \"audio\") {\n        track.stop();\n      }\n    });\n}\n","import { useState } from \"react\";\n\nfunction Call() {\n  const [state, setState] = useState(0);\n  const [btnText, setBtnText] = useState(\"Call\");\n\n  const click = function () {\n    state === 0 && (setState(1) || setBtnText(\"Dialling\"));\n    state === 1 && (setState(0) || setBtnText(\"Call\"));\n    // state === 1 && (setState(2) || setBtnText(\"End\"));\n    state === 2 && (setState(0) || setBtnText(\"Call\"));\n  };\n\n  const answer = function () {\n    state === 1 && (setState(2) || setBtnText(\"End\"));\n  };\n\n  return { state, click, btnText, answer };\n}\n\nexport default Call;\n","import React from \"react\";\nimport Audio from \"./component/Audio\";\nimport Call from \"./hooks/Call\";\n\nfunction App() {\n  const { state, click, btnText, answer } = Call();\n\n  return (\n    <div className=\"App\">\n      <div className=\"logo\">\n        <h4>TalkTime</h4>\n      </div>\n      <div>\n        <h5>Find someone to talk to.</h5>\n      </div>\n      <div className=\"audio-animation\">\n        <Audio type={state} answer={answer} />\n      </div>\n      <div className=\"button\">\n        <button onClick={click} className={btnText}>\n          {btnText}\n        </button>\n      </div>\n      <div className=\"footer\">\n        <a href=\"/privacy\">Privacy Policy</a> | <a href=\"/terms\">Terms</a>\n      </div>\n\n      {/* <section id=\"share-view\" class=\"row\">\n        <h3 id=\"share-title\">Copy and Share this URL:</h3>\n        <div id=\"callIDView\" class=\"input-group col-sm-8 col-sm-offset-2\">\n          <input\n            id=\"callID\"\n            type=\"text\"\n            class=\"form-control\"\n            aria-label=\"...\"\n            readonly\n          />\n          <div class=\"input-group-btn\">\n            <span id=\"isTURN\" class=\"input-group-addon\">\n              <input id=\"isTURNcb\" type=\"checkbox\" aria-label=\"...\" />\n              <label for=\"isTURN\"> Force TURN</label>\n            </span>\n          </div>\n        </div>\n      </section> */}\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}